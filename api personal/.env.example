# ------------------------------------------------------------
# personalv5-enterprise-api - Example ENV (NO SECRETS)
# Copiá a .env y reemplazá valores según tu entorno.
# ------------------------------------------------------------

# runtime
NODE_ENV=development
PORT=3000

# Si estás detrás de reverse proxy (nginx/cloudflare), en PROD suele ser 1
TRUST_PROXY=0

# timeouts (ms)
REQUEST_TIMEOUT_MS=30000
DB_QUERY_TIMEOUT_MS=30000

# ------------------------------------------------------------
# DB (dev / prod)
# ------------------------------------------------------------
DB_HOST=127.0.0.1
DB_PORT=3306
DB_NAME=personalv5
DB_USER=root
DB_PASSWORD=CHANGE_ME

# pool (enterprise defaults)
DB_POOL_MAX=10
DB_POOL_MIN=0
DB_POOL_ACQUIRE_MS=30000
DB_POOL_IDLE_MS=10000

# ------------------------------------------------------------
# TESTS (Jest)
# Nota: Jest setup copia DB_*_TEST -> DB_* cuando NODE_ENV=test.
# ------------------------------------------------------------
DB_HOST_TEST=127.0.0.1
DB_PORT_TEST=3306
DB_NAME_TEST=personalv5_test
DB_USER_TEST=root
DB_PASSWORD_TEST=CHANGE_ME

# schema cache
SCHEMA_CACHE_PATH=./.cache/schema.json

# ------------------------------------------------------------
# OpenAPI
# ------------------------------------------------------------
ENABLE_OPENAPI_VALIDATION=true
OPENAPI_PATH=docs/openapi.yaml

# ------------------------------------------------------------
# hardening
# ------------------------------------------------------------
ENABLE_HARDENING=true
ENABLE_REQUEST_BODY_LIMITS=true
ENABLE_COMPRESSION=true

# ------------------------------------------------------------
# IP guard
# (coma separada). Si allowlist está vacío => no restringe.
# ------------------------------------------------------------
IP_ALLOWLIST=
IP_BLACKLIST=

# ------------------------------------------------------------
# CORS
# Recomendación PROD: CORS_ALLOW_ALL=false y usar allowlist/denylist.
# ------------------------------------------------------------
CORS_ALLOW_ALL=true
CORS_DENYLIST=

# ------------------------------------------------------------
# Rate limit
# ------------------------------------------------------------
RATE_LIMIT_ENABLE=true
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX=300

# ------------------------------------------------------------
# CRUD (enterprise)
# ------------------------------------------------------------
CRUD_READONLY=false
CRUD_STRICT_ALLOWLIST=false
CRUD_TABLE_ALLOWLIST=
CRUD_TABLE_DENYLIST=schema_migrations,sequelizemeta,audit_log,refresh_tokens,api_keys,auth_login_guard,security_bans,idempotency_keys
CRUD_REQUIRE_ID_PK=false

# ------------------------------------------------------------
# Metrics
# Si METRICS_PROTECT=true => requiere METRICS_TOKEN (fail-fast)
# Token se puede pasar como:
# - header: x-metrics-token: <token>
# - Authorization: Bearer <token>
# ------------------------------------------------------------
METRICS_ENABLE=true
METRICS_PATH=/metrics
METRICS_PROTECT=false
METRICS_TOKEN=CHANGE_ME_LONG_RANDOM

# ------------------------------------------------------------
# Logging
# ------------------------------------------------------------
LOG_DIR=./logs
LOG_LEVEL=info
LOG_RETENTION_DAYS=30
# ------------------------------------------------------------
# MIGRACION
# ------------------------------------------------------------
MIGRATIONS_ENABLE=false
MIGRATIONS_DIR=db/migrations



AUTH_ENABLE=true
RBAC_ENABLE=true
AUTH_ALLOW_DEV_USER_ID_HEADER=true

